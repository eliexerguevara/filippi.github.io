<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Programa de actividad con el Superintendente de circuito y su esposa</title>
<style>
  * {
    box-sizing: border-box;
  }
  
  body {
    font-family: Arial, sans-serif;
    margin: 10px;
    background: #f5f5f5;
    color: #333;
  }
  
  h2 {
    text-align: center;
    color: #222;
    margin-bottom: 15px;
    font-size: 18px;
    font-weight: bold;
  }
  
  h3 {
    background-color: #e5e5e5;
    padding: 8px 10px;
    border-radius: 4px;
    margin-top: 12px;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: bold;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 12px;
    background: white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  
  td, th {
    border: 1px solid #666;
    padding: 8px;
    vertical-align: middle;
    font-size: 13px;
    line-height: 1.4;
  }
  
  th {
    text-align: left;
    background: #f8f8f8;
    font-weight: bold;
  }
  
  label {
    font-weight: bold;
    font-size: 12px;
    display: block;
  }
  
  input[type="text"] {
    width: 100%;
    border: 1px solid #ccc;
    color: #c62828;
    font-size: 14px;
    padding: 8px;
    background: white;
    font-family: Arial, sans-serif;
    line-height: 1.4;
    border-radius: 3px;
  }
  
  input[type="text"]:focus {
    outline: 2px solid #2b6cb0;
    background-color: #fffbeb;
    border-color: #2b6cb0;
  }
  
  input::placeholder {
    color: #999;
    font-size: 13px;
  }
  
  .container {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .button-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin: 25px 0;
    flex-wrap: wrap;
  }
  
  button {
    padding: 12px 24px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  
  button:active {
    transform: translateY(0);
  }
  
  #btnGuardar {
    background: #38a169;
    color: white;
  }
  
  #btnGuardar:hover {
    background: #2f855a;
  }
  
  #btnLimpiar {
    background: #e53e3e;
    color: white;
  }
  
  #btnLimpiar:hover {
    background: #c53030;
  }
  
  #btnImprimir {
    background: #805ad5;
    color: white;
  }
  
  #btnImprimir:hover {
    background: #6b46c1;
  }
  
  .mensaje {
    text-align: center;
    padding: 12px;
    margin: 15px 0;
    border-radius: 6px;
    display: none;
    font-weight: 500;
    font-size: 14px;
    animation: slideDown 0.3s ease;
  }
  
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .exito {
    background-color: #c6f6d5;
    color: #22543d;
    border: 2px solid #9ae6b4;
  }
  
  .error {
    background-color: #fed7d7;
    color: #742a2a;
    border: 2px solid #feb2b2;
  }
  
  .info {
    background-color: #bee3f8;
    color: #1a365d;
    border: 2px solid #90cdf4;
  }
  
  .fila-fija {
    background-color: #fafafa;
  }
  
  /* Estilos para impresión */
  @media print {
    @page {
      size: A4 portrait;
      margin: 8mm 6mm;
    }
    
    /* Ocultar todo el contenido de Google Sites */
    body > *:not(#appFormulario) {
      display: none !important;
    }
    
    /* Asegurar que solo se vea el formulario */
    #appFormulario {
      display: block !important;
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
    }
    
    .button-container,
    .mensaje {
      display: none !important;
    }
    
    body {
      background: white;
      margin: 0;
      padding: 0;
    }
    
    .container {
      box-shadow: none;
      padding: 5mm;
      border-radius: 0;
      max-width: 100%;
    }
    
    h2 {
      font-size: 13px;
      margin-bottom: 6px;
      page-break-after: avoid;
    }
    
    h3 {
      background-color: #e0e0e0;
      padding: 4px 6px;
      margin-top: 5px;
      margin-bottom: 3px;
      font-size: 10px;
      page-break-after: avoid;
      page-break-inside: avoid;
    }
    
    table {
      page-break-inside: avoid;
      margin-bottom: 4px;
      font-size: 9px;
      box-shadow: none;
    }
    
    td, th {
      padding: 2px 4px;
      border: 1px solid #333;
      font-size: 9px;
      line-height: 1.2;
    }
    
    th {
      background: #f5f5f5;
    }
    
    input[type="text"] {
      border: none;
      padding: 0;
      font-size: 9px;
      color: #000;
      background: transparent;
      box-shadow: none;
    }
    
    label {
      font-size: 9px;
    }
    
    .fila-fija {
      background-color: #f5f5f5;
    }
    
    /* Forzar todo en una página */
    .container {
      page-break-inside: avoid;
    }
    
    .container > * {
      page-break-inside: avoid;
    }
  }
  
  /* Responsive para móviles */
  @media screen and (max-width: 768px) {
    body {
      margin: 5px;
      background: #f9f9f9;
    }
    
    .container {
      padding: 15px;
      border-radius: 6px;
    }
    
    h2 {
      font-size: 16px;
      margin-bottom: 12px;
    }
    
    h3 {
      font-size: 13px;
      padding: 8px;
      margin-top: 15px;
    }
    
    table {
      font-size: 12px;
      margin-bottom: 15px;
    }
    
    td, th {
      padding: 10px 8px;
      font-size: 13px;
    }
    
    label {
      font-size: 12px;
      margin-bottom: 4px;
    }
    
    input[type="text"] {
      font-size: 16px !important;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 6px;
      min-height: 44px;
    }
    
    button {
      padding: 14px 20px;
      font-size: 16px;
      width: 100%;
      margin-bottom: 10px;
      min-height: 48px;
    }
    
    .button-container {
      flex-direction: column;
      gap: 0;
      margin: 20px 0;
    }
    
    table {
      display: block;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      white-space: nowrap;
    }
  }
  
  @media screen and (max-width: 480px) {
    .container {
      padding: 12px;
    }
    
    h2 {
      font-size: 15px;
    }
    
    h3 {
      font-size: 12px;
      padding: 7px;
    }
  }
</style>
</head>
<body>

<div id="appFormulario">
  <div class="container" id="formularioPDF">
    <h2>Programa de actividad con el Superintendente de circuito y su esposa</h2>
    
    <div id="mensajeExito" class="mensaje exito"></div>
    <div id="mensajeError" class="mensaje error"></div>
    <div id="mensajeInfo" class="mensaje info"></div>

    <form id="programaForm" onsubmit="return false;">
      <table>
        <tr>
          <td style="width: 20%"><label>CONGREGACIÓN:</label></td>
          <td style="width: 30%"><input type="text" id="congregacion" required></td>
          <td style="width: 25%"><label>HORA REUNIÓN MARTES:</label></td>
          <td style="width: 25%"><input type="text" id="horaReunion" placeholder="19:30" required></td>
        </tr>
        <tr>
          <td><label>PRESIDENTE:</label></td>
          <td><input type="text" id="presidente" required></td>
          <td><label>TESOROS BIBLIA:</label></td>
          <td><input type="text" id="tesoros" required></td>
        </tr>
        <tr>
          <td><label>ORACIÓN FINAL:</label></td>
          <td colspan="3"><input type="text" id="oracion" required></td>
        </tr>
      </table>

      <h3>MIÉRCOLES</h3>
      <table>
        <tr>
          <th style="width: 20%">DETALLE</th>
          <th style="width: 12%">HORA</th>
          <th style="width: 28%">ARREGLO/ACTIVIDAD</th>
          <th style="width: 28%">DIRECCIÓN</th>
          <th style="width: 12%">N° TERRI</th>
        </tr>
        <tr>
          <th>SERVICIO CAMPO:</th>
          <td><input type="text" data-field="mier_serv_hora" placeholder="9:00"></td>
          <td><input type="text" data-field="mier_serv_act"></td>
          <td><input type="text" data-field="mier_serv_dir"></td>
          <td><input type="text" data-field="mier_serv_terr"></td>
        </tr>
        <tr>
          <th>ALMUERZO:</th>
          <td><input type="text" data-field="mier_alm_hora" placeholder="13:00"></td>
          <td><input type="text" data-field="mier_alm_act"></td>
          <td><input type="text" data-field="mier_alm_dir"></td>
          <td><input type="text" data-field="mier_alm_terr"></td>
        </tr>
        <tr>
          <th>PASTOREO:</th>
          <td><input type="text" data-field="mier_past_hora" placeholder="16:00"></td>
          <td><input type="text" data-field="mier_past_act"></td>
          <td><input type="text" data-field="mier_past_dir"></td>
          <td><input type="text" data-field="mier_past_terr"></td>
        </tr>
        <tr class="fila-fija">
          <th>REUNIÓN ESPECIAL:</th>
          <td>20:00</td>
          <td>REUNIÓN CON LOS PRECURSORES</td>
          <td>SALÓN DEL REINO</td>
          <td></td>
        </tr>
      </table>

      <h3>JUEVES</h3>
      <table>
        <tr>
          <th style="width: 20%">DETALLE</th>
          <th style="width: 12%">HORA</th>
          <th style="width: 28%">ARREGLO/ACTIVIDAD</th>
          <th style="width: 28%">DIRECCIÓN</th>
          <th style="width: 12%">N° TERRI</th>
        </tr>
        <tr>
          <th>SERVICIO CAMPO:</th>
          <td><input type="text" data-field="juev_serv_hora" placeholder="9:00"></td>
          <td><input type="text" data-field="juev_serv_act"></td>
          <td><input type="text" data-field="juev_serv_dir"></td>
          <td><input type="text" data-field="juev_serv_terr"></td>
        </tr>
        <tr>
          <th>ALMUERZO:</th>
          <td><input type="text" data-field="juev_alm_hora" placeholder="13:00"></td>
          <td><input type="text" data-field="juev_alm_act"></td>
          <td><input type="text" data-field="juev_alm_dir"></td>
          <td><input type="text" data-field="juev_alm_terr"></td>
        </tr>
        <tr>
          <th>PASTOREO:</th>
          <td><input type="text" data-field="juev_past_hora" placeholder="16:00"></td>
          <td><input type="text" data-field="juev_past_act"></td>
          <td><input type="text" data-field="juev_past_dir"></td>
          <td><input type="text" data-field="juev_past_terr"></td>
        </tr>
      </table>

      <h3>VIERNES</h3>
      <table>
        <tr>
          <th style="width: 20%">DETALLE</th>
          <th style="width: 12%">HORA</th>
          <th style="width: 28%">ARREGLO/ACTIVIDAD</th>
          <th style="width: 28%">DIRECCIÓN</th>
          <th style="width: 12%">N° TERRI</th>
        </tr>
           <th>NO ASISTIREMOS</th>
          <td></td>
          <td>Ustedes si quieren programen salida</td>
          <td></td>
        <tr>
          <th>CURSO DE LA BIBLIA:</th>
          <td><input type="text" data-field="vier_cur_hora" placeholder="16:30"></td>
          <td><input type="text" data-field="vier_cur_act"></td>
          <td><input type="text" data-field="vier_cur_dir"></td>
          <td><input type="text" data-field="vier_cur_terr"></td>
        </tr>
        <tr>
          <th>SERVICIO DE CAMPO:</th>
          <td><input type="text" data-field="vier_serv_hora" placeholder="18:00"></td>
          <td><input type="text" data-field="vier_serv_act"></td>
          <td><input type="text" data-field="vier_serv_dir"></td>
          <td><input type="text" data-field="vier_serv_terr"></td>
        </tr>
          <th>REUNIÓN:</th>
          <td>20:00</td>
          <td>REUNIÓN CON ANCIANOS Y SIERVOS MINISTERIALES</td>
          <td>SALÓN DEL REINO</td>
          <td></td>
        </tr>
      </table>

      <h3>SÁBADO</h3>
      <table>
        <tr>
          <th style="width: 20%">DETALLE</th>
          <th style="width: 12%">HORA</th>
          <th style="width: 28%">ARREGLO/ACTIVIDAD</th>
          <th style="width: 28%">DIRECCIÓN</th>
          <th style="width: 12%">N° TERRI</th>
        </tr>
        <tr>
          <th>SERVICIO CAMPO:</th>
          <td><input type="text" data-field="sab_serv_hora" placeholder="9:00"></td>
          <td><input type="text" data-field="sab_serv_act"></td>
          <td><input type="text" data-field="sab_serv_dir"></td>
          <td><input type="text" data-field="sab_serv_terr"></td>
        </tr>
        <tr>
          <th>ALMUERZO:</th>
          <td><input type="text" data-field="sab_alm_hora" placeholder="13:00"></td>
          <td><input type="text" data-field="sab_alm_act"></td>
          <td><input type="text" data-field="sab_alm_dir"></td>
          <td><input type="text" data-field="sab_alm_terr"></td>
        </tr>
        </tr>
          <th>REUNIÓN:</th>
          <td>20:00</td>
          <td>REUNION DE CONGREGACION</td>
          <td>SALÓN DEL REINO</td>
          <td></td>
        </tr>
      </table>

      <h3>DOMINGO</h3>
      <table>
        <tr>
          <th style="width: 20%">DETALLE</th>
          <th style="width: 12%">HORA</th>
          <th style="width: 28%">ARREGLO/ACTIVIDAD</th>
          <th style="width: 28%">DIRECCIÓN</th>
          <th style="width: 12%">N° TERRI</th>
        </tr>
        <tr>
          <th>SERVICIO CAMPO:</th>
          <td><input type="text" data-field="dom_serv_hora" placeholder="9:00"></td>
          <td><input type="text" data-field="dom_serv_act"></td>
          <td><input type="text" data-field="dom_serv_dir"></td>
          <td><input type="text" data-field="dom_serv_terr"></td>
        </tr>
        <tr>
          <th>ALMUERZO:</th>
          <td><input type="text" data-field="dom_alm_hora" placeholder="13:00"></td>
          <td><input type="text" data-field="dom_alm_act"></td>
          <td><input type="text" data-field="dom_alm_dir"></td>
          <td><input type="text" data-field="dom_alm_terr"></td>
        </tr>
        <tr>
          <th>SERVICIO CAMPO:</th>
          <td><input type="text" data-field="dom_serv_hora" placeholder="16:00"></td>
          <td><input type="text" data-field="dom_serv_act"></td>
          <td><input type="text" data-field="dom_serv_dir"></td>
          <td><input type="text" data-field="dom_serv_terr"></td>
        </tr>
      </table>
    </form>
  </div>

  <div class="button-container">
    <button type="button" id="btnImprimir" onclick="imprimirFormulario(); return false;">🖨️ Imprimir</button>
    <button type="button" id="btnGuardar" onclick="guardarDatos(); return false;">💾 Guardar</button>
    <button type="button" id="btnLimpiar" onclick="limpiarFormulario(); return false;">🗑️ Limpiar</button>
  </div>
</div>


<script>
var datosApp = {};

function mostrarMensaje(tipo, mensaje) {
  var tipoId = tipo === 'exito' ? 'mensajeExito' : tipo === 'error' ? 'mensajeError' : 'mensajeInfo';
  var elemento = document.getElementById(tipoId);
  
  if (elemento) {
    elemento.textContent = mensaje;
    elemento.style.display = 'block';
    setTimeout(function() { 
      elemento.style.display = 'none'; 
    }, 4000);
  }
}

function validarFormulario() {
  var camposRequeridos = ['congregacion', 'horaReunion', 'presidente', 'tesoros', 'oracion'];
  
  for (var i = 0; i < camposRequeridos.length; i++) {
    var campo = camposRequeridos[i];
    var input = document.getElementById(campo);
    if (!input || !input.value.trim()) {
      mostrarMensaje('error', 'Complete el campo: ' + campo.toUpperCase());
      if (input) input.focus();
      return false;
    }
  }
  return true;
}

function guardarDatos() {
  datosApp = {};
  
  var camposConId = ['congregacion', 'horaReunion', 'presidente', 'tesoros', 'oracion'];
  for (var i = 0; i < camposConId.length; i++) {
    var id = camposConId[i];
    var input = document.getElementById(id);
    if (input) datosApp[id] = input.value;
  }
  
  var camposConDataField = document.querySelectorAll('[data-field]');
  for (var j = 0; j < camposConDataField.length; j++) {
    var input2 = camposConDataField[j];
    var field = input2.getAttribute('data-field');
    datosApp[field] = input2.value;
  }
  
  mostrarMensaje('exito', '¡Datos guardados correctamente!');
  return false;
}

function limpiarFormulario() {
  if (confirm('¿Desea limpiar el formulario?')) {
    document.getElementById('programaForm').reset();
    datosApp = {};
    mostrarMensaje('info', 'Formulario limpiado');
  }
  return false;
}

function imprimirFormulario() {
  if (!validarFormulario()) {
    return false;
  }
  
  guardarDatos();
  
  setTimeout(function() {
    try {
      window.print();
    } catch (e) {
      alert('Por favor use Ctrl+P (Cmd+P en Mac) para imprimir');
    }
  }, 300);
  
  return false;
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Formulario cargado correctamente');
  });
} else {
  console.log('Formulario cargado correctamente');
}
</script>

</body>
</html>
